{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "85fc62e1",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "package not found, installing w/ conda...\n",
      "Collecting package metadata (current_repodata.json): done\n",
      "Solving environment: failed with initial frozen solve. Retrying with flexible solve.\n",
      "Solving environment: failed with repodata from current_repodata.json, will retry with next repodata source.\n",
      "Collecting package metadata (repodata.json): done\n",
      "Solving environment: done\n",
      "\n",
      "## Package Plan ##\n",
      "\n",
      "  environment location: /Users/MT/anaconda3/envs/onl\n",
      "\n",
      "  added / updated specs:\n",
      "    - geopandas\n",
      "\n",
      "\n",
      "The following packages will be downloaded:\n",
      "\n",
      "    package                    |            build\n",
      "    ---------------------------|-----------------\n",
      "    boost-cpp-1.74.0           |       hbdcdab7_3        15.6 MB  conda-forge\n",
      "    ca-certificates-2021.5.30  |       h033912b_0         136 KB  conda-forge\n",
      "    cairo-1.16.0               |    he43a7df_1008         1.3 MB  conda-forge\n",
      "    certifi-2021.5.30          |   py39h6e9494a_0         141 KB  conda-forge\n",
      "    cfitsio-3.470              |       h01dc385_7         1.3 MB  conda-forge\n",
      "    click-7.1.2                |     pyh9f0ad1d_0          64 KB  conda-forge\n",
      "    click-plugins-1.1.1        |             py_0           9 KB  conda-forge\n",
      "    cligj-0.7.2                |     pyhd8ed1ab_0          10 KB  conda-forge\n",
      "    conda-4.10.1               |   py39h6e9494a_0         3.0 MB  conda-forge\n",
      "    curl-7.77.0                |       hb861fe1_0         138 KB  conda-forge\n",
      "    dbus-1.13.6                |       ha13b53f_2         544 KB  conda-forge\n",
      "    expat-2.4.1                |       he49afe7_0         143 KB  conda-forge\n",
      "    fiona-1.8.20               |   py39h673eaac_0         1.0 MB  conda-forge\n",
      "    fontconfig-2.13.1          |    h10f422b_1005         271 KB  conda-forge\n",
      "    freexl-1.0.6               |       h0d85af4_0          42 KB  conda-forge\n",
      "    gdal-3.2.2                 |   py39h0530131_3         1.4 MB  conda-forge\n",
      "    geopandas-0.9.0            |     pyhd8ed1ab_1           5 KB  conda-forge\n",
      "    geopandas-base-0.9.0       |     pyhd8ed1ab_1         950 KB  conda-forge\n",
      "    geotiff-1.6.0              |       hba2ba3e_5         126 KB  conda-forge\n",
      "    giflib-5.2.1               |       hbcb3906_2          71 KB  conda-forge\n",
      "    glib-2.68.2                |       he49afe7_2         439 KB  conda-forge\n",
      "    glib-tools-2.68.2          |       he49afe7_2          80 KB  conda-forge\n",
      "    hdf4-4.2.15                |       hefd3b78_3         885 KB  conda-forge\n",
      "    hdf5-1.10.6                |nompi_hc5d9132_1114         3.1 MB  conda-forge\n",
      "    icu-68.1                   |       h74dc148_0        12.7 MB  conda-forge\n",
      "    joblib-1.0.1               |     pyhd8ed1ab_0         206 KB  conda-forge\n",
      "    jpeg-9d                    |       hbcb3906_0         250 KB  conda-forge\n",
      "    json-c-0.15                |       hcb556a6_0          70 KB  conda-forge\n",
      "    kealib-1.4.14              |       h31dd65d_2         156 KB  conda-forge\n",
      "    libblas-3.9.0              |            9_mkl          12 KB  conda-forge\n",
      "    libcblas-3.9.0             |            9_mkl          11 KB  conda-forge\n",
      "    libclang-11.1.0            |default_he082bbe_1        14.4 MB  conda-forge\n",
      "    libdap4-3.20.6             |       h3e144a0_2         2.2 MB  conda-forge\n",
      "    libgdal-3.2.2              |       h9a52621_3         8.8 MB  conda-forge\n",
      "    libglib-2.68.2             |       hd556434_2         2.8 MB  conda-forge\n",
      "    libkml-1.3.0               |    h8fd9edb_1013         481 KB  conda-forge\n",
      "    liblapack-3.9.0            |            9_mkl          11 KB  conda-forge\n",
      "    libllvm11-11.1.0           |       hd011deb_2        22.5 MB  conda-forge\n",
      "    libnetcdf-4.8.0            |nompi_hb4d10b0_103         1.3 MB  conda-forge\n",
      "    libpq-13.3                 |       hea3049e_0         2.7 MB  conda-forge\n",
      "    librttopo-1.1.0            |       h5413771_6         218 KB  conda-forge\n",
      "    libspatialindex-1.9.3      |       h1c7c35f_3         399 KB  conda-forge\n",
      "    libspatialite-5.0.1        |       heb715ac_4         4.2 MB  conda-forge\n",
      "    libxml2-2.9.12             |       h93ec3fd_0         685 KB  conda-forge\n",
      "    libzip-1.7.3               |       hbc046b2_0         108 KB  conda-forge\n",
      "    mapclassify-2.4.2          |     pyhd8ed1ab_0          36 KB  conda-forge\n",
      "    munch-2.5.0                |             py_0          12 KB  conda-forge\n",
      "    mysql-common-8.0.23        |       h694c41f_2         1.5 MB  conda-forge\n",
      "    mysql-libs-8.0.23          |       h54f5a68_2         1.8 MB  conda-forge\n",
      "    networkx-2.5               |             py_0         1.2 MB  conda-forge\n",
      "    nspr-4.30                  |       hcd9eead_0         246 KB  conda-forge\n",
      "    nss-3.64                   |       h31e2bf1_0         2.0 MB  conda-forge\n",
      "    openjpeg-2.4.0             |       h6e7aa92_1         374 KB  conda-forge\n",
      "    openssl-1.1.1k             |       h0d85af4_0         1.9 MB  conda-forge\n",
      "    pcre-8.44                  |       hb1e8313_0         220 KB  conda-forge\n",
      "    pixman-0.40.0              |       hbcb3906_0         615 KB  conda-forge\n",
      "    poppler-21.03.0            |       h640f9a4_0         1.6 MB  conda-forge\n",
      "    poppler-data-0.4.10        |                0         3.8 MB  conda-forge\n",
      "    postgresql-13.3            |       he8fe76e_0         4.7 MB  conda-forge\n",
      "    proj-8.0.0                 |       h1512c50_0         2.8 MB  conda-forge\n",
      "    pyproj-3.1.0               |   py39h45acd42_0         462 KB  conda-forge\n",
      "    pyqt-5.12.3                |   py39h6e9494a_7          21 KB  conda-forge\n",
      "    pyqt-impl-5.12.3           |   py39hef7122c_7         4.7 MB  conda-forge\n",
      "    pyqt5-sip-4.19.18          |   py39hd8f94c5_7         275 KB  conda-forge\n",
      "    pyqtchart-5.12             |   py39hef7122c_7         212 KB  conda-forge\n",
      "    pyqtwebengine-5.12.1       |   py39hef7122c_7         140 KB  conda-forge\n",
      "    qt-5.12.9                  |       h126340a_4        87.8 MB  conda-forge\n",
      "    rtree-0.9.7                |   py39h7d0d40a_1          45 KB  conda-forge\n",
      "    scikit-learn-0.24.2        |   py39h4b1dcc9_0         6.7 MB  conda-forge\n",
      "    scipy-1.6.3                |   py39h056f1c0_0        18.6 MB  conda-forge\n",
      "    threadpoolctl-2.1.0        |     pyh5ca1d4c_0          15 KB  conda-forge\n",
      "    tiledb-2.2.9               |       he9a4fb4_0         2.6 MB  conda-forge\n",
      "    tzcode-2021a               |       h0d85af4_1          62 KB  conda-forge\n",
      "    xerces-c-3.2.3             |       h379762d_2         1.5 MB  conda-forge\n",
      "    ------------------------------------------------------------\n",
      "                                           Total:       250.6 MB\n",
      "\n",
      "The following NEW packages will be INSTALLED:\n",
      "\n",
      "  boost-cpp          conda-forge/osx-64::boost-cpp-1.74.0-hbdcdab7_3\n",
      "  cairo              conda-forge/osx-64::cairo-1.16.0-he43a7df_1008\n",
      "  cfitsio            conda-forge/osx-64::cfitsio-3.470-h01dc385_7\n",
      "  click-plugins      conda-forge/noarch::click-plugins-1.1.1-py_0\n",
      "  cligj              conda-forge/noarch::cligj-0.7.2-pyhd8ed1ab_0\n",
      "  curl               conda-forge/osx-64::curl-7.77.0-hb861fe1_0\n",
      "  dbus               conda-forge/osx-64::dbus-1.13.6-ha13b53f_2\n",
      "  expat              conda-forge/osx-64::expat-2.4.1-he49afe7_0\n",
      "  fiona              conda-forge/osx-64::fiona-1.8.20-py39h673eaac_0\n",
      "  fontconfig         conda-forge/osx-64::fontconfig-2.13.1-h10f422b_1005\n",
      "  freexl             conda-forge/osx-64::freexl-1.0.6-h0d85af4_0\n",
      "  gdal               conda-forge/osx-64::gdal-3.2.2-py39h0530131_3\n",
      "  geopandas          conda-forge/noarch::geopandas-0.9.0-pyhd8ed1ab_1\n",
      "  geopandas-base     conda-forge/noarch::geopandas-base-0.9.0-pyhd8ed1ab_1\n",
      "  geotiff            conda-forge/osx-64::geotiff-1.6.0-hba2ba3e_5\n",
      "  giflib             conda-forge/osx-64::giflib-5.2.1-hbcb3906_2\n",
      "  glib               conda-forge/osx-64::glib-2.68.2-he49afe7_2\n",
      "  glib-tools         conda-forge/osx-64::glib-tools-2.68.2-he49afe7_2\n",
      "  hdf4               conda-forge/osx-64::hdf4-4.2.15-hefd3b78_3\n",
      "  hdf5               conda-forge/osx-64::hdf5-1.10.6-nompi_hc5d9132_1114\n",
      "  joblib             conda-forge/noarch::joblib-1.0.1-pyhd8ed1ab_0\n",
      "  json-c             conda-forge/osx-64::json-c-0.15-hcb556a6_0\n",
      "  kealib             conda-forge/osx-64::kealib-1.4.14-h31dd65d_2\n",
      "  libblas            conda-forge/osx-64::libblas-3.9.0-9_mkl\n",
      "  libcblas           conda-forge/osx-64::libcblas-3.9.0-9_mkl\n",
      "  libclang           conda-forge/osx-64::libclang-11.1.0-default_he082bbe_1\n",
      "  libdap4            conda-forge/osx-64::libdap4-3.20.6-h3e144a0_2\n",
      "  libgdal            conda-forge/osx-64::libgdal-3.2.2-h9a52621_3\n",
      "  libgfortran5       conda-forge/osx-64::libgfortran5-9.3.0-h6c81a4c_22\n",
      "  libglib            conda-forge/osx-64::libglib-2.68.2-hd556434_2\n",
      "  libkml             conda-forge/osx-64::libkml-1.3.0-h8fd9edb_1013\n",
      "  liblapack          conda-forge/osx-64::liblapack-3.9.0-9_mkl\n",
      "  libllvm11          conda-forge/osx-64::libllvm11-11.1.0-hd011deb_2\n",
      "  libnetcdf          conda-forge/osx-64::libnetcdf-4.8.0-nompi_hb4d10b0_103\n",
      "  libpq              conda-forge/osx-64::libpq-13.3-hea3049e_0\n",
      "  librttopo          conda-forge/osx-64::librttopo-1.1.0-h5413771_6\n",
      "  libspatialindex    conda-forge/osx-64::libspatialindex-1.9.3-h1c7c35f_3\n",
      "  libspatialite      conda-forge/osx-64::libspatialite-5.0.1-heb715ac_4\n",
      "  libzip             conda-forge/osx-64::libzip-1.7.3-hbc046b2_0\n",
      "  mapclassify        conda-forge/noarch::mapclassify-2.4.2-pyhd8ed1ab_0\n",
      "  munch              conda-forge/noarch::munch-2.5.0-py_0\n",
      "  mysql-common       conda-forge/osx-64::mysql-common-8.0.23-h694c41f_2\n",
      "  mysql-libs         conda-forge/osx-64::mysql-libs-8.0.23-h54f5a68_2\n",
      "  networkx           conda-forge/noarch::networkx-2.5-py_0\n",
      "  nspr               conda-forge/osx-64::nspr-4.30-hcd9eead_0\n",
      "  nss                conda-forge/osx-64::nss-3.64-h31e2bf1_0\n",
      "  openjpeg           conda-forge/osx-64::openjpeg-2.4.0-h6e7aa92_1\n",
      "  pcre               conda-forge/osx-64::pcre-8.44-hb1e8313_0\n",
      "  pixman             conda-forge/osx-64::pixman-0.40.0-hbcb3906_0\n",
      "  poppler            conda-forge/osx-64::poppler-21.03.0-h640f9a4_0\n",
      "  poppler-data       conda-forge/noarch::poppler-data-0.4.10-0\n",
      "  postgresql         conda-forge/osx-64::postgresql-13.3-he8fe76e_0\n",
      "  proj               conda-forge/osx-64::proj-8.0.0-h1512c50_0\n",
      "  pyproj             conda-forge/osx-64::pyproj-3.1.0-py39h45acd42_0\n",
      "  pyqt-impl          conda-forge/osx-64::pyqt-impl-5.12.3-py39hef7122c_7\n",
      "  pyqt5-sip          conda-forge/osx-64::pyqt5-sip-4.19.18-py39hd8f94c5_7\n",
      "  pyqtchart          conda-forge/osx-64::pyqtchart-5.12-py39hef7122c_7\n",
      "  pyqtwebengine      conda-forge/osx-64::pyqtwebengine-5.12.1-py39hef7122c_7\n",
      "  rtree              conda-forge/osx-64::rtree-0.9.7-py39h7d0d40a_1\n",
      "  scikit-learn       conda-forge/osx-64::scikit-learn-0.24.2-py39h4b1dcc9_0\n",
      "  threadpoolctl      conda-forge/noarch::threadpoolctl-2.1.0-pyh5ca1d4c_0\n",
      "  tiledb             conda-forge/osx-64::tiledb-2.2.9-he9a4fb4_0\n",
      "  tzcode             conda-forge/osx-64::tzcode-2021a-h0d85af4_1\n",
      "  xerces-c           conda-forge/osx-64::xerces-c-3.2.3-h379762d_2\n",
      "\n",
      "The following packages will be UPDATED:\n",
      "\n",
      "  ca-certificates    pkgs/main::ca-certificates-2021.5.25-~ --> conda-forge::ca-certificates-2021.5.30-h033912b_0\n",
      "  icu                        pkgs/main::icu-58.2-h0a44026_3 --> conda-forge::icu-68.1-h74dc148_0\n",
      "  jpeg                        pkgs/main::jpeg-9b-he5867d9_2 --> conda-forge::jpeg-9d-hbcb3906_0\n",
      "  libgfortran        pkgs/main::libgfortran-3.0.1-h93005f0~ --> conda-forge::libgfortran-5.0.0-9_3_0_h6c81a4c_22\n",
      "  libxml2              pkgs/main::libxml2-2.9.10-h7cdb67c_3 --> conda-forge::libxml2-2.9.12-h93ec3fd_0\n",
      "  pyqt                 pkgs/main::pyqt-5.9.2-py39h23ab428_6 --> conda-forge::pyqt-5.12.3-py39h6e9494a_7\n",
      "  qt                         pkgs/main::qt-5.9.7-h468cd18_1 --> conda-forge::qt-5.12.9-h126340a_4\n",
      "  scipy               pkgs/main::scipy-1.6.2-py39hd5f7400_1 --> conda-forge::scipy-1.6.3-py39h056f1c0_0\n",
      "\n",
      "The following packages will be SUPERSEDED by a higher-priority channel:\n",
      "\n",
      "  certifi            pkgs/main::certifi-2021.5.30-py39hecd~ --> conda-forge::certifi-2021.5.30-py39h6e9494a_0\n",
      "  click              conda-forge/osx-64::click-8.0.1-py39h~ --> conda-forge/noarch::click-7.1.2-pyh9f0ad1d_0\n",
      "  conda              pkgs/main::conda-4.10.1-py39hecd8cb5_1 --> conda-forge::conda-4.10.1-py39h6e9494a_0\n",
      "  openssl              pkgs/main::openssl-1.1.1k-h9ed2024_0 --> conda-forge::openssl-1.1.1k-h0d85af4_0\n",
      "\n",
      "\n",
      "\n",
      "Downloading and Extracting Packages\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "fiona-1.8.20         | 1.0 MB    | ##################################### | 100% \n",
      "rtree-0.9.7          | 45 KB     | ##################################### | 100% \n",
      "threadpoolctl-2.1.0  | 15 KB     | ##################################### | 100% \n",
      "libnetcdf-4.8.0      | 1.3 MB    | ##################################### | 100% \n",
      "click-plugins-1.1.1  | 9 KB      | ##################################### | 100% \n",
      "openjpeg-2.4.0       | 374 KB    | ##################################### | 100% \n",
      "libspatialite-5.0.1  | 4.2 MB    | ##################################### | 100% \n",
      "geopandas-base-0.9.0 | 950 KB    | ##################################### | 100% \n",
      "hdf5-1.10.6          | 3.1 MB    | ##################################### | 100% \n",
      "proj-8.0.0           | 2.8 MB    | ##################################### | 100% \n",
      "nspr-4.30            | 246 KB    | ##################################### | 100% \n",
      "libgdal-3.2.2        | 8.8 MB    | ##################################### | 100% \n",
      "networkx-2.5         | 1.2 MB    | ##################################### | 100% \n",
      "pyqt5-sip-4.19.18    | 275 KB    | ##################################### | 100% \n",
      "xerces-c-3.2.3       | 1.5 MB    | ##################################### | 100% \n",
      "ca-certificates-2021 | 136 KB    | ##################################### | 100% \n",
      "libkml-1.3.0         | 481 KB    | ##################################### | 100% \n",
      "pyqt-impl-5.12.3     | 4.7 MB    | ##################################### | 100% \n",
      "glib-2.68.2          | 439 KB    | ##################################### | 100% \n",
      "liblapack-3.9.0      | 11 KB     | ##################################### | 100% \n",
      "libpq-13.3           | 2.7 MB    | ##################################### | 100% \n",
      "certifi-2021.5.30    | 141 KB    | ##################################### | 100% \n",
      "libcblas-3.9.0       | 11 KB     | ##################################### | 100% \n",
      "geotiff-1.6.0        | 126 KB    | ##################################### | 100% \n",
      "munch-2.5.0          | 12 KB     | ##################################### | 100% \n",
      "libdap4-3.20.6       | 2.2 MB    | ##################################### | 100% \n",
      "libzip-1.7.3         | 108 KB    | ##################################### | 100% \n",
      "pyqtchart-5.12       | 212 KB    | ##################################### | 100% \n",
      "icu-68.1             | 12.7 MB   | ##################################### | 100% \n",
      "poppler-21.03.0      | 1.6 MB    | ##################################### | 100% \n",
      "boost-cpp-1.74.0     | 15.6 MB   | ##################################### | 100% \n",
      "pyqtwebengine-5.12.1 | 140 KB    | ##################################### | 100% \n",
      "scikit-learn-0.24.2  | 6.7 MB    | ##################################### | 100% \n",
      "freexl-1.0.6         | 42 KB     | ##################################### | 100% \n",
      "libllvm11-11.1.0     | 22.5 MB   | ##################################### | 100% \n",
      "click-7.1.2          | 64 KB     | ##################################### | 100% \n",
      "pyproj-3.1.0         | 462 KB    | ##################################### | 100% \n",
      "hdf4-4.2.15          | 885 KB    | ##################################### | 100% \n",
      "openssl-1.1.1k       | 1.9 MB    | ##################################### | 100% \n",
      "libspatialindex-1.9. | 399 KB    | ##################################### | 100% \n",
      "fontconfig-2.13.1    | 271 KB    | ##################################### | 100% \n",
      "curl-7.77.0          | 138 KB    | ##################################### | 100% \n",
      "jpeg-9d              | 250 KB    | ##################################### | 100% \n",
      "glib-tools-2.68.2    | 80 KB     | ##################################### | 100% \n",
      "conda-4.10.1         | 3.0 MB    | ##################################### | 100% \n",
      "scipy-1.6.3          | 18.6 MB   | ##################################### | 100% \n",
      "pyqt-5.12.3          | 21 KB     | ##################################### | 100% \n",
      "gdal-3.2.2           | 1.4 MB    | ##################################### | 100% \n",
      "geopandas-0.9.0      | 5 KB      | ##################################### | 100% \n",
      "json-c-0.15          | 70 KB     | ##################################### | 100% \n",
      "poppler-data-0.4.10  | 3.8 MB    | ##################################### | 100% \n",
      "tzcode-2021a         | 62 KB     | ##################################### | 100% \n",
      "kealib-1.4.14        | 156 KB    | ##################################### | 100% \n",
      "dbus-1.13.6          | 544 KB    | ##################################### | 100% \n",
      "libxml2-2.9.12       | 685 KB    | ##################################### | 100% \n",
      "expat-2.4.1          | 143 KB    | ##################################### | 100% \n",
      "nss-3.64             | 2.0 MB    | ##################################### | 100% \n",
      "pixman-0.40.0        | 615 KB    | ##################################### | 100% \n",
      "giflib-5.2.1         | 71 KB     | ##################################### | 100% \n",
      "cairo-1.16.0         | 1.3 MB    | ##################################### | 100% \n",
      "pcre-8.44            | 220 KB    | ##################################### | 100% \n",
      "mysql-common-8.0.23  | 1.5 MB    | ##################################### | 100% \n",
      "libglib-2.68.2       | 2.8 MB    | ##################################### | 100% \n",
      "tiledb-2.2.9         | 2.6 MB    | ##################################### | 100% \n",
      "joblib-1.0.1         | 206 KB    | ##################################### | 100% \n",
      "cfitsio-3.470        | 1.3 MB    | ##################################### | 100% \n",
      "libclang-11.1.0      | 14.4 MB   | ##################################### | 100% \n",
      "mapclassify-2.4.2    | 36 KB     | ##################################### | 100% \n",
      "qt-5.12.9            | 87.8 MB   | ##################################### | 100% \n",
      "cligj-0.7.2          | 10 KB     | ##################################### | 100% \n",
      "librttopo-1.1.0      | 218 KB    | ##################################### | 100% \n",
      "postgresql-13.3      | 4.7 MB    | ##################################### | 100% \n",
      "mysql-libs-8.0.23    | 1.8 MB    | ##################################### | 100% \n",
      "libblas-3.9.0        | 12 KB     | ##################################### | 100% \n",
      "Preparing transaction: done\n",
      "Verifying transaction: done\n",
      "Executing transaction: done\n"
     ]
    }
   ],
   "source": [
    "import json # part of the base library that comes w/ Python, we dont need to install this separately\n",
    "\n",
    "# reminder that if you are installing libraries in a Google Colab instance you will be prompted to restart your kernal\n",
    "import geemap, ee\n",
    "\n",
    "try:\n",
    "    import geopandas as gpd\n",
    "except ModuleNotFoundError:\n",
    "    if 'google.colab' in str(get_ipython()):\n",
    "        print(\"package not found, installing w/ pip in Google Colab...\")\n",
    "        !pip install geemap geopandas\n",
    "    else:\n",
    "        print(\"package not found, installing w/ conda...\")\n",
    "        !conda install geopandas -c conda-forge -y\n",
    "    import geopandas as gpd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "59059bff",
   "metadata": {},
   "outputs": [],
   "source": [
    "try:\n",
    "        ee.Initialize()\n",
    "except Exception as e:\n",
    "        ee.Authenticate()\n",
    "        ee.Initialize()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "58e7340f",
   "metadata": {},
   "outputs": [],
   "source": [
    "# location of shapefile locally\n",
    "sydney_shp_path = \"/Users/MT/Desktop/CRISC/city_of_sydney_shapefile/sydney.shp\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "d1452c12",
   "metadata": {},
   "outputs": [],
   "source": [
    "# we read our shapefile in to a geopandas data frame using the geopandas.read_file method\n",
    "# we'll make sure it's initiated in the EPSG 4326 CRS\n",
    "sydney_gdf = gpd.read_file(sydney_shp_path, crs='EPSG:4326')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "7b6ae6e1",
   "metadata": {},
   "outputs": [],
   "source": [
    "# define a helper function to put the geodataframe in the right format for constructing an ee object\n",
    "def shp_to_ee_fmt(geodf):\n",
    "    data = json.loads(geodf.to_json())\n",
    "    return data['features'][0]['geometry']['coordinates']\n",
    "\n",
    "# create the ee object\n",
    "sydney = ee.Geometry.MultiPolygon(shp_to_ee_fmt(sydney_gdf))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "5a26f1d9",
   "metadata": {},
   "outputs": [],
   "source": [
    "viirs2018 = ee.ImageCollection(\"NOAA/VIIRS/DNB/MONTHLY_V1/VCMSLCFG\").filterDate('2018-01-01','2018-12-31').select('avg_rad').median()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "7bb4fe9e",
   "metadata": {},
   "outputs": [],
   "source": [
    "sydney_viirs = viirs2018.clip(sydney)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "cdb1377e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "af382b7c701745e589e59eb004a9be7e",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "Map(center=[-33.889462622418314, 151.20275194560503], controls=(WidgetControl(options=['position', 'transparen…"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "sydMap = geemap.Map()\n",
    "sydMap.add_basemap(\"SATELLITE\")\n",
    "sydMap.centerObject(sydney, zoom=13)\n",
    "sydMap.addLayer(sydney_viirs, {'min':1, 'max':100}, 'VIIRS 2018', opacity=.75)\n",
    "sydMap.addLayerControl()\n",
    "sydMap"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python (onl)",
   "language": "python",
   "name": "onl"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
